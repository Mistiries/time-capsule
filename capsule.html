<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Achraf and Eleni's Time Capsule</title>

<style>
body {
  margin: 0;
  overflow: hidden;
  background: url("images/backgroundwall.webp") no-repeat center center fixed;
  background-size: cover;
  font-family: Arial, sans-serif;
}

/* ---------------- BURGER BUTTON ---------------- */
#burgerBtn {
  position: fixed;
  top: 20px;
  left: 20px;
  width: 42px;
  height: 42px;
  background: rgba(255,255,255,0.85);
  border-radius: 8px;
  cursor: pointer;
  z-index: 4000;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 22px;
}

/* ---------------- BURGER PANEL ---------------- */
#burgerPanel {
  position: fixed;
  top: 0;
  left: -260px;
  width: 260px;
  height: 100%;
  background: rgba(255,255,255,0.95);
  box-shadow: 4px 0 12px rgba(0,0,0,0.25);
  transition: left 0.3s ease;
  z-index: 3500;
  padding: 20px;
}

#burgerPanel.open {
  left: 0;
}

/* music buttons side by side */
.music-controls {
  display: flex;
  gap: 10px;
  margin-top: 20px;
}

.music-controls button {
  flex: 1;
  padding: 8px;
  cursor: pointer;
}

/* ---------------- DRAGGABLE ITEMS ---------------- */
.draggable {
  position: absolute;
  cursor: grab;
  user-select: none;
}

/* ---------------- TRAY ---------------- */
#tray {
  position: fixed;
  bottom: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 520px;
  height: 120px;
  background: rgba(255,255,255,0.9);
  border-radius: 12px 12px 0 0;
  z-index: 500;
  overflow: visible;
}

/* ---------------- TRASH BIN ---------------- */
#trashBin {
  position: fixed;
  bottom: 140px;
  right: 40px;
  width: 80px;
  height: 80px;
  background: rgba(0,0,0,0.4);
  border-radius: 10px;
  z-index: 600;
}
</style>
</head>

<body>

<!-- BURGER -->
<div id="burgerBtn">☰</div>

<div id="burgerPanel">
  <h3>Music</h3>
  <div class="music-controls">
    <button id="prevTrack">◀</button>
    <button id="nextTrack">▶</button>
  </div>
</div>

<!-- DRAGGABLE ITEMS -->
<img src="images/envelope.webp" class="draggable" id="envelope" style="top:200px;left:200px;width:120px;">
<img src="images/peachtea.webp" class="draggable" id="peachTea" style="top:260px;left:380px;width:90px;">
<img src="images/memorytab.webp" class="draggable" style="top:180px;left:520px;width:110px;">

<!-- TRAY -->
<div id="tray"></div>

<!-- TRASH -->
<div id="trashBin"></div>

<!-- AUDIO -->
<audio id="bg1" src="sounds/background.mp3" loop></audio>
<audio id="bg2" src="sounds/background2.mp3" loop></audio>
<audio id="bg3" src="sounds/background3.mp3" loop></audio>

<audio id="pickupSound" src="sounds/pickup.mp3"></audio>
<audio id="binSound" src="sounds/bin.mp3"></audio>

<script>
/* ---------------- BURGER LOGIC ---------------- */
const burgerBtn = document.getElementById("burgerBtn");
const burgerPanel = document.getElementById("burgerPanel");

burgerBtn.onclick = () => {
  burgerPanel.classList.toggle("open");
};

/* ---------------- MUSIC PLAYER ---------------- */
const tracks = [
  document.getElementById("bg1"),
  document.getElementById("bg2"),
  document.getElementById("bg3")
];

let currentTrack = 0;

function playTrack(index) {
  tracks.forEach(t => {
    t.pause();
    t.currentTime = 0;
  });
  tracks[index].play();
}

window.addEventListener("load", () => {
  playTrack(0);
});

document.getElementById("nextTrack").onclick = () => {
  currentTrack = (currentTrack + 1) % tracks.length;
  playTrack(currentTrack);
};

document.getElementById("prevTrack").onclick = () => {
  currentTrack = (currentTrack - 1 + tracks.length) % tracks.length;
  playTrack(currentTrack);
};

/* ---------------- DRAGGING (FIXED) ---------------- */
const tray = document.getElementById("tray");
const trashBin = document.getElementById("trashBin");
const pickupSound = document.getElementById("pickupSound");
const binSound = document.getElementById("binSound");

let active = null;
let offX = 0;
let offY = 0;

document.querySelectorAll(".draggable").forEach(el => {
  el.addEventListener("mousedown", e => {
    e.preventDefault();
    active = el;

    const rect = el.getBoundingClientRect();
    offX = e.clientX - rect.left;
    offY = e.clientY - rect.top;

    document.body.appendChild(el);
    el.style.left = rect.left + "px";
    el.style.top = rect.top + "px";
    el.style.zIndex = 3000;

    pickupSound.currentTime = 0;
    pickupSound.play();

    document.addEventListener("mousemove", drag);
    document.addEventListener("mouseup", drop);
  });
});

function drag(e) {
  if (!active) return;
  active.style.left = e.clientX - offX + "px";
  active.style.top = e.clientY - offY + "px";
  active.style.transform = `rotate(${Math.sin(Date.now()/80)*2}deg)`;
}

function drop() {
  if (!active) return;

  const itemRect = active.getBoundingClientRect();
  const trayRect = tray.getBoundingClientRect();
  const binRect = trashBin.getBoundingClientRect();

  const overTray =
    itemRect.bottom > trayRect.top &&
    itemRect.left < trayRect.right &&
    itemRect.right > trayRect.left;

  const overBin =
    itemRect.right > binRect.left &&
    itemRect.left < binRect.right &&
    itemRect.bottom > binRect.top &&
    itemRect.top < binRect.bottom;

  if (overBin) {
    binSound.currentTime = 0;
    binSound.play();
    active.remove();
  } else if (overTray) {
    tray.appendChild(active);
    active.style.left = "10px";
    active.style.top = "10px";
  }

  active.style.transform = "rotate(0deg)";
  active.style.zIndex = "";
  active = null;

  document.removeEventListener("mousemove", drag);
  document.removeEventListener("mouseup", drop);
}
</script>

</body>
</html>
